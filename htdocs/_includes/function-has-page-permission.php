<?php
function has_page_permission($role, $page=NULL) {
  $page = $page ?: strtok($_SERVER["REQUEST_URI"], '?');
  $role_permissions = [
    '_public' => [
      BASEURL . 'login.php',
      BASEURL . '404.php',
      BASEURL . 'register.php',
    ],
    'student' => [
      BASEURL . 'feedback.php',
      BASEURL . 'submit-feedback.php',
      BASEURL . 'index.php',
      BASEURL . '404.php',
      BASEURL . 'logout.php',
      BASEURL . 'course-team.php',
      BASEURL . 'calendar.php',
      BASEURL . 'lectures.php',
      BASEURL . 'labs.php',
      BASEURL . 'assignments.php',
      BASEURL . 'exams.php',
      BASEURL . 'student-grades.php',
      BASEURL . 'student-remark.php',
      BASEURL . 'assignments/2018-02-09-a1.php',
      BASEURL . 'assignments/2018-03-09-a2.php',
      BASEURL . 'assignments/2018-03-24-a3.php',
      BASEURL . 'lectures/2018-01-01-quiz-soln.php',
      BASEURL . 'lectures/2018-01-08-lec1.php',
      BASEURL . 'lectures/2018-01-15-lec2.php',
      BASEURL . 'lectures/2018-01-15-ps1.php',
      BASEURL . 'lectures/2018-01-22-lec3.php',
      BASEURL . 'lectures/2018-01-22-ps2.php',
      BASEURL . 'lectures/2018-01-29-lec4.php',
      BASEURL . 'lectures/2018-02-05-lec5.php',
      BASEURL . 'lectures/2018-02-05-ps3.php',
      BASEURL . 'lectures/2018-02-19-lec7.php',
      BASEURL . 'lectures/2018-02-26-lec9.php',
      BASEURL . 'lectures/2018-03-05-lec10.php',
      BASEURL . 'lectures/2018-03-12-lec11.php',
      BASEURL . 'lectures/2018-03-19-lec12.php',
      BASEURL . 'exams/2018-02-05-midterm.php',
      BASEURL . 'labs/2018-01-08-software-inst.php',
      BASEURL . 'labs/2018-01-08-w1.php',
      BASEURL . 'labs/2018-01-15-w2.php',
      BASEURL . 'labs/2018-01-22-w3.php',
      BASEURL . 'labs/2018-01-29-w4.php',
      BASEURL . 'labs/2018-02-05-w5.php',
      BASEURL . 'labs/2018-02-12-w6.php',
      BASEURL . 'labs/2018-02-26-w7.php',
      BASEURL . 'labs/2018-03-05-w8.php',
      BASEURL . 'labs/2018-03-12-w9.php',
      BASEURL . 'labs/2018-03-19-w10.php',
      BASEURL . 'labs/2018-03-26-w11.php',
    ],
    'ta' => [
      BASEURL . 'index.php',
      BASEURL . '404.php',
      BASEURL . 'logout.php',
      BASEURL . 'course-team.php',
      BASEURL . 'calendar.php',
      BASEURL . 'lectures.php',
      BASEURL . 'labs.php',
      BASEURL . 'assignments.php',
      BASEURL . 'class-grades.php',
      BASEURL . 'exams.php',
      BASEURL . 'remark.php',
      BASEURL . 'update-grade.php',
      BASEURL . 'assignments/2018-02-09-a1.php',
      BASEURL . 'assignments/2018-03-09-a2.php',
      BASEURL . 'assignments/2018-03-24-a3.php',
      BASEURL . 'lectures/2018-01-01-quiz-soln.php',
      BASEURL . 'lectures/2018-01-08-lec1.php',
      BASEURL . 'lectures/2018-01-15-lec2.php',
      BASEURL . 'lectures/2018-01-15-ps1.php',
      BASEURL . 'lectures/2018-01-22-lec3.php',
      BASEURL . 'lectures/2018-01-22-ps2.php',
      BASEURL . 'lectures/2018-01-29-lec4.php',
      BASEURL . 'lectures/2018-02-05-lec5.php',
      BASEURL . 'lectures/2018-02-05-ps3.php',
      BASEURL . 'lectures/2018-02-19-lec7.php',
      BASEURL . 'lectures/2018-02-26-lec9.php',
      BASEURL . 'lectures/2018-03-05-lec10.php',
      BASEURL . 'lectures/2018-03-12-lec11.php',
      BASEURL . 'lectures/2018-03-19-lec12.php',
      BASEURL . 'exams/2018-02-05-midterm.php',
      BASEURL . 'labs/2018-01-08-software-inst.php',
      BASEURL . 'labs/2018-01-08-w1.php',
      BASEURL . 'labs/2018-01-15-w2.php',
      BASEURL . 'labs/2018-01-22-w3.php',
      BASEURL . 'labs/2018-01-29-w4.php',
      BASEURL . 'labs/2018-02-05-w5.php',
      BASEURL . 'labs/2018-02-12-w6.php',
      BASEURL . 'labs/2018-02-26-w7.php',
      BASEURL . 'labs/2018-03-05-w8.php',
      BASEURL . 'labs/2018-03-12-w9.php',
      BASEURL . 'labs/2018-03-19-w10.php',
      BASEURL . 'labs/2018-03-26-w11.php',
    ],
    'instructor' => [
      BASEURL . 'index.php',
      BASEURL . '404.php',
      BASEURL . 'logout.php',
      BASEURL . 'course-team.php',
      BASEURL . 'calendar.php',
      BASEURL . 'lectures.php',
      BASEURL . 'labs.php',
      BASEURL . 'assignments.php',
      BASEURL . 'exams.php',
      BASEURL . 'class-grades.php',
      BASEURL . 'instructor-feedback.php',
      BASEURL . 'remark.php',
      BASEURL . 'update-grade.php',
      BASEURL . 'assignments/2018-02-09-a1.php',
      BASEURL . 'assignments/2018-03-09-a2.php',
      BASEURL . 'assignments/2018-03-24-a3.php',
      BASEURL . 'lectures/2018-01-01-quiz-soln.php',
      BASEURL . 'lectures/2018-01-08-lec1.php',
      BASEURL . 'lectures/2018-01-15-lec2.php',
      BASEURL . 'lectures/2018-01-15-ps1.php',
      BASEURL . 'lectures/2018-01-22-lec3.php',
      BASEURL . 'lectures/2018-01-22-ps2.php',
      BASEURL . 'lectures/2018-01-29-lec4.php',
      BASEURL . 'lectures/2018-02-05-lec5.php',
      BASEURL . 'lectures/2018-02-05-ps3.php',
      BASEURL . 'lectures/2018-02-19-lec7.php',
      BASEURL . 'lectures/2018-02-26-lec9.php',
      BASEURL . 'lectures/2018-03-05-lec10.php',
      BASEURL . 'lectures/2018-03-12-lec11.php',
      BASEURL . 'lectures/2018-03-19-lec12.php',
      BASEURL . 'exams/2018-02-05-midterm.php',
      BASEURL . 'labs/2018-01-08-software-inst.php',
      BASEURL . 'labs/2018-01-08-w1.php',
      BASEURL . 'labs/2018-01-15-w2.php',
      BASEURL . 'labs/2018-01-22-w3.php',
      BASEURL . 'labs/2018-01-29-w4.php',
      BASEURL . 'labs/2018-02-05-w5.php',
      BASEURL . 'labs/2018-02-12-w6.php',
      BASEURL . 'labs/2018-02-26-w7.php',
      BASEURL . 'labs/2018-03-05-w8.php',
      BASEURL . 'labs/2018-03-12-w9.php',
      BASEURL . 'labs/2018-03-19-w10.php',
      BASEURL . 'labs/2018-03-26-w11.php',
    ],
  ];
  return in_array($page, $role_permissions[$role]);
}
